<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

    <title>CNNè®­ç»ƒæ¨ç†æ‰‹å†™æ•°å­—</title>
    <link rel="stylesheet" type="text/css" href="../css/logd.css" />

    <!-- å¼•å…¥ä¸è’œå­è®¡æ•° -->
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>

<body class="with-sidebar">

    <!-- header -->
    <header>
        <h1>CNNè®­ç»ƒæ¨ç†æ‰‹å†™æ•°å­—</h1>

        <section class="doc-main-info">
            <p class="doc-author text-comment em-comment">George</p>
            <p class="doc-last-update text-comment em-comment">25-05-14</p>
            <p class="doc-first-on text-comment em-comment">25-05-14</p>

            <p class="text-comment em-comment">
                <span id="busuanzi_container_page_pv">
                    | æµè§ˆé‡ï¼š<span id="busuanzi_value_page_pv"></span>ğŸ‘€
                </span>
                &nbsp|&nbsp
                è¿”å›<a href="./stt-ascend-dk-all.html">
                    <å®éªŒè¯¾>
                </a>
            </p>
        </section>
    </header>

    <!-- footer -->
    <footer>
        <p>
            &copy George Donne 2024-2025. All Rights Reserved. è‹ICPå¤‡2021027062å·-1&nbsp&nbsp|&nbsp&nbsp
            <a href="./logd-about.html">å…³äº</a>
        </p>

        <p>
            Support: <a href="mailto:georgedonnev2@outlook.com">georgedonnev2@outlook.com</a>
        </p>

        <p>
            <span id="busuanzi_container_site_pv">
                æœ¬ç«™æµè§ˆé‡ï¼š<span id="busuanzi_value_site_pv"></span>ğŸ‘€
            </span>
            &nbsp&nbsp|&nbsp&nbsp
            <span id="busuanzi_container_site_uv">
                æœ¬ç«™è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>ğŸ‘¤
            </span>
        </p>
    </footer>

    <!-- sidebar -->
    <aside>
        <p class="em-larger">ç›®å½•</p>

        <a href="#brief-dataset">ç®€ä»‹å’Œæ•°æ®é›†</a><br>
        <a href="#train-infer">è®­ç»ƒå’Œæ¨ç†</a><br>
        <!-- <a href="#shutdown-dk">å…³æœº</a><br>
        <a href="#appendix">é™„å½•</a><br>
        &nbsp&nbsp<a href="#ascend-website">å®˜ç½‘é“¾æ¥</a><br>
        &nbsp&nbsp<a href="#vscode-to-dk">VSCodeè¿å¼€å‘æ¿</a><br> -->
    </aside>

    <!-- main -->
    <main class="with-sidebar">

        <!--  -->
        <section>
            <h2 id="brief-dataset">
                <a href="#brief-dataset">ç®€ä»‹å’Œæ•°æ®é›†</a>
            </h2>

            <!--  -->
            <h3 id="cnn-mnist-brief">
                <a href="#cnn-mnist-brief">ç®€ä»‹</a>
            </h3>

            <p>
                å·ç§¯ç¥ç»ç½‘ç»œï¼ˆConvolutional Neural Network,
                CNNï¼‰æ˜¯ä¸€ç§æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå¹¿æ³›åº”ç”¨äºè®¡ç®—æœºè§†è§‰ä»»åŠ¡ä¸­ï¼Œå°¤å…¶æ˜¯åœ¨å›¾åƒåˆ†ç±»å’Œç‰©ä½“è¯†åˆ«æ–¹é¢ã€‚ä¸ä¼ ç»Ÿçš„å…¨è¿æ¥ç¥ç»ç½‘ç»œç›¸æ¯”ï¼ŒCNNé€šè¿‡å¼•å…¥å±€éƒ¨è¿æ¥ã€æƒé‡å…±äº«å’Œæ± åŒ–å±‚ç­‰æœºåˆ¶ï¼Œèƒ½å¤Ÿæœ‰æ•ˆæ•æ‰å›¾åƒä¸­çš„ç©ºé—´ç‰¹å¾ï¼Œä»è€Œæå‡æ¨¡å‹çš„æ€§èƒ½å’Œè®¡ç®—æ•ˆç‡ã€‚
            </p>

            <p>
                æœ¬å®éªŒæ—¨åœ¨åˆ©ç”¨å·ç§¯ç¥ç»ç½‘ç»œæ„å»ºä¸€ä¸ªå›¾åƒåˆ†ç±»æ¨¡å‹ï¼Œä»¥è¯†åˆ«æ‰‹å†™æ•°å­—æ•°æ®é›† MNISTï¼ˆModified National Institute of Standards and Technologyï¼‰ã€‚MNIST
                æ•°æ®é›†åŒ…å« 70,000 å¼  28x28 åƒç´ çš„ç°åº¦æ‰‹å†™æ•°å­—å›¾åƒï¼Œæ¶µç›–ä» 0 åˆ° 9 çš„åä¸ªç±»åˆ«ã€‚ç”±äºå…¶è§„æ¨¡é€‚ä¸­ä¸”ç›¸å¯¹ç®€å•ï¼ŒMNIST æ•°æ®é›†æˆä¸ºæ·±åº¦å­¦ä¹ ç ”ç©¶å’Œæ•™å­¦ä¸­å¸¸ç”¨çš„åŸºå‡†æ•°æ®é›†ã€‚
            </p>
            <p class="em-comment text-comment">
                åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/2201_75436278/article/details/143417507"
                    target="_blank">ã€å·ç§¯ç¥ç»ç½‘ç»œã€‘MINSTæ•°æ®é›†è¯†åˆ« | æ‰‹å†™æ•°å­—è¯†åˆ«</a>
            </p>

            <!--  -->
            <h3 id="dataset">
                <a href="#dataset">æ•°æ®é›†</a>
            </h3>

            <p>
                ä½¿ç”¨ PyTorch æ¡†æ¶æ—¶ï¼Œæ•°æ®é›†é€šå¸¸æ”¾åœ¨ <code> data/MNIST/raw </code> ç›®å½•ä¸‹ã€‚
            </p>
            <p>
                æ¯”å¦‚ï¼Œè®­ç»ƒå’Œæ¨ç†ç”¨ä»£ç æ”¾åœ¨ <code> /root/ailab </code> ç›®å½•ä¸‹ï¼Œåˆ™æ•°æ®é›†æ”¾åœ¨ <code> /root/ailab/data/MNIST/raw </code> ç›®å½•ä¸­ã€‚
            </p>
            <p>
                å¯ä»ç½‘ä¸Šè‡ªè¡Œä¸‹è½½ï¼Œæˆ–ä»å¦‚ä¸‹é“¾æ¥ä¸‹è½½ã€‚å…± 4 ä¸ª .gz æ–‡ä»¶ï¼Œä¸‹è½½åæ”¾å…¥ä¸Šè¿°æ•°æ®é›†ç›®å½•ä¸­ã€‚
            </p>
            <a href="../doc/mnist-dataset/t10k-images-idx3-ubyte.gz">t10k-images-idx3-ubyte.gz</a><br>
            <a href="../doc/mnist-dataset/t10k-labels-idx1-ubyte.gz">t10k-labels-idx1-ubyte.gz</a><br>
            <a href="../doc/mnist-dataset/train-images-idx3-ubyte.gz">train-images-idx3-ubyte.gz</a><br>
            <a href="../doc/mnist-dataset/train-labels-idx1-ubyte.gz">train-labels-idx1-ubyte.gz</a><br>


        </section>

        <!--  -->
        <section>
            <h2 id="train-infer">
                <a href="#train-infer">è®­ç»ƒå’Œæ¨ç†</a>
            </h2>

            <!--  -->
            <h3 id="source-code">
                <a href="#source-code">æºä»£ç </a>
            </h3>

            <p>
                å¯ä»¥å’¨è¯¢å¤§æ¨¡å‹è·å¾—æºä»£ç æ¡†æ¶ã€‚æ¯”å¦‚ï¼šè¾“å‡ºåŸºäº PyTorch æ¡†æ¶çš„ Python å®Œæ•´ä»£ç ï¼Œç”¨äºè®­ç»ƒ mnist å’Œæ¨ç†ï¼Œéœ€è¦è¯¦ç»†æ³¨é‡Šã€‚
            </p>
            <p>
                ä¹Ÿå¯ä»å¦‚ä¸‹é“¾æ¥ä¸‹è½½ï¼Œå…±å‚è€ƒã€‚
            </p>
            <a href="../src/train_mnist_ascend_250513.py">train_mnist_ascend_250513.py</a><br>
            <a href="../src/infer_mnist_ascend_250513.py">infer_mnist_ascend_250513.py</a>


            <!--  -->
            <h3 id="run-debug">
                <a href="#run-debug">è¿è¡Œå’Œè°ƒæµ‹</a>
            </h3>
            <p>
                train_mnist_ascend_250513.py è¿è¡Œç»“æœå¦‚ä¸‹ï¼ˆä»¥è®­ç»ƒ 5 ä¸ª epoch ä¸ºä¾‹ï¼‰
            </p>
            <pre><code>
(base) root@davinci-mini:~/ailab# python3 train_mnist_ascend_250513.py
[è­¦å‘Š] torch_npuæ¨¡å—æœªæ‰¾åˆ°ï¼Œå°†å›é€€åˆ°CPUè®­ç»ƒ
å½“å‰è®­ç»ƒè®¾å¤‡: cpu
/usr/local/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py:626: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 3, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
===== MNISTè®­ç»ƒå¼€å§‹ =====
ä½¿ç”¨è®¾å¤‡: cpu
è®­ç»ƒæ ·æœ¬æ•°: 60000
æ‰¹é‡å¤§å°: 64
æ€»è¿­ä»£æ¬¡æ•°: 938æ¬¡/epoch
/usr/local/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
/usr/local/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:1538: UserWarning: dropout2d: Received a 2-D input to dropout2d, which is deprecated and will result in an error in a future release. To retain the behavior and silence this warning, please use dropout instead. Note that dropout2d exists to provide channel-wise dropout on inputs with 2 spatial dimensions, a channel dimension, and an optional batch dimension (i.e. 3D or 4D inputs).
  warnings.warn(warn_msg)
Epoch:  1 [     0/60000 (0%)]  Loss: 2.306371 elapsed_time: 0.7181 secs
Epoch:  1 [   640/60000 (1%)]  Loss: 1.105067 elapsed_time: 4.5227 secs
Epoch:  1 [  1280/60000 (2%)]  Loss: 0.960787 elapsed_time: 8.2586 secs
Epoch:  1 [  1920/60000 (3%)]  Loss: 0.525667 elapsed_time: 11.9629 secs
...
Epoch:  2 [ 58880/60000 (98%)]  Loss: 0.151442 elapsed_time: 335.6310 secs
Epoch:  2 [ 59520/60000 (99%)]  Loss: 0.055742 elapsed_time: 339.3682 secs
total_elapsed_time: 690.2588 ç§’
...
Epoch:  3 [ 58880/60000 (98%)]  Loss: 0.033503 elapsed_time: 335.6799 secs
Epoch:  3 [ 59520/60000 (99%)]  Loss: 0.015223 elapsed_time: 339.1351 secs
total_elapsed_time: 1031.5982 ç§’
...
Epoch:  4 [ 58880/60000 (98%)]  Loss: 0.035570 elapsed_time: 333.4938 secs
Epoch:  4 [ 59520/60000 (99%)]  Loss: 0.121509 elapsed_time: 337.1759 secs
total_elapsed_time: 1371.1106 ç§’
...
Epoch:  5 [ 58880/60000 (98%)]  Loss: 0.004134 elapsed_time: 340.5883 secs
Epoch:  5 [ 59520/60000 (99%)]  Loss: 0.042905 elapsed_time: 344.2381 secs
total_elapsed_time: 1717.5507 ç§’

            </code>

            </pre>

            <p class="em-bold">
                è¯´æ˜<br>
                1ã€å¯¹äºæ‰‹å†™ä»£ç ï¼Œæˆ–ä»å¤§æ¨¡å‹è·å–çš„ä»£ç ï¼Œå»ºè®®å¢åŠ æ‰“å°ä¿¡æ¯ï¼Œç¡®ä¿è®­ç»ƒæŒ‰é¢„æœŸè¿›è¡Œã€‚<br>
                2ã€è§‚å¯Ÿè®­ç»ƒè€—æ—¶ï¼Œä»¥ä¾¿è®¾ç½®åˆç†çš„ epochã€‚<br>
                3ã€å‡çº§å¼€å‘æ¿çš„ torchã€torchvisionã€torchaudioï¼Œå¯ç¼©çŸ­è®­ç»ƒè€—æ—¶ã€‚<span class="em-normal em-comment text-comment">ä»¥ä¸Šè¿°æ ·ä¾‹ä»£ç ä¸ºä¾‹ï¼Œå‡çº§å‰å®Œæˆ 1ä¸ªepochçº¦è€—æ—¶ 16 åˆ†é’Ÿï¼Œå‡çº§ååªéœ€è¦ 6 åˆ†é’Ÿã€‚ </span><br>
                4ã€è¿˜å¯å®‰è£…æ˜‡è…¾æä¾›çš„ torch_npuï¼ˆå¾…éªŒè¯ï¼‰ã€‚
            </p>
            <hr>
            <p>
                infer_mnist_ascend_250513.py æ‰§è¡Œç»“æœå¦‚ä¸‹ã€‚å¯æ‰‹å†™0-9ï¼Œæ‹ç…§ï¼Œå¤„ç†ä¸º 28 * 28 åƒç´ çš„å›¾ç‰‡ï¼Œç„¶åä¸Šä¼ åˆ°å¼€å‘æ¿ä¸Šåšæ¨ç†éªŒè¯ï¼›æˆ–ç”¨å…¶ä»–æ–¹æ³•ç”Ÿæˆã€‚
            </p>
            <pre><code>
(base) root@davinci-mini:~/ailab# python3 infer_mnist_ascend_250513.py
[è­¦å‘Š] torch_npuæ¨¡å—æœªæ‰¾åˆ°ï¼Œå°†ä½¿ç”¨CPUæ¨ç†
å½“å‰æ¨ç†è®¾å¤‡: cpu
æ¨¡å‹å·²ä» mnist_model_e5.pth åŠ è½½

æ­£åœ¨é¢„å¤„ç†å›¾åƒ...
æ­£åœ¨è¿›è¡Œæ¨ç†...
/usr/local/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:1538: UserWarning: dropout2d: Received a 2-D input to dropout2d, which is deprecated and will result in an error in a future release. To retain the behavior and silence this warning, please use dropout instead. Note that dropout2d exists to provide channel-wise dropout on inputs with 2 spatial dimensions, a channel dimension, and an optional batch dimension (i.e. 3D or 4D inputs).
  warnings.warn(warn_msg)

===== è¯†åˆ«ç»“æœ =====
é¢„æµ‹æ•°å­—: 8

ASCIIè¡¨ç¤º:
 _ 
|_|
|_|
</code></pre>

        </section>

    </main>

</body>

</html>